{% extends "mail/message.html" %}
{% comment %}

    Copyright 2015-2016 GoodCrypto
    Last modified: 2016-02-04

{% endcomment %}
{% load i18n custom %}

{% block titlevar %}Verification Status{% endblock %}

                        {% block sig_headers %}
                        <th scope="col">
                           <div class="text">
                                <abbr title="Message signed with the same key used to encrypt it.">
                                    <a href="#Signed">Private<br/>signed</a>
                                </abbr>
                            </div>
                           <div class="clear"></div>
                        </th>
                        <th scope="col">
                           <div class="text">
                                <abbr title="Message signed separately from any encryption.">
                                    <a href="#ClearSigned">Clear<br/>signed</a>
                                </abbr>
                            </div>
                           <div class="clear"></div>
                        </th>
                        <th scope="col">
                           <div class="text">
                                <abbr title="Message signed with the sender's mail server key (DKIM).">
                                    <a href="#DomainSigned">Domain<br/>signed</a>
                                </abbr>
                            </div>
                           <div class="clear"></div>
                        </th>
                        {% endblock sig_headers %}
                        {% block verify_header %}
                        <th scope="col">
                           <div class="text">
                                <abbr title="ID in message's header">
                                    <a href="#MessageID">Message ID</a>
                                </abbr>
                            </div>
                           <div class="clear"></div>
                        </th>
                        <th scope="col">
                           <div class="text">
                                <abbr title="Code generated by your GoodCrypto private server">
                                    <a href="#VerificationCode">Verification code</a>
                                </abbr>
                            </div>
                           <div class="clear"></div>
                        </th>
                        {% endblock verify_header %}

                            {% block signatures %}
                            <td scope="col">
                               <center>
                                {% if result.record.private_signed %}
                                    {% if result.record.private_sig_verified %}
                                    <abbr title="Signed with the same key that encrypted it.">
                                        <img alt="Yes" src="/static/images/general/check_mark_small.png">
                                    </abbr>
                                    {% else %}
                                    <abbr title="Signed with the same key that encrypted it. Signature NOT verified.">
                                        <img alt="Yes*" src="/static/images/general/error_mark_small.png">
                                    </abbr>
                                    {% endif %}
                                {% else %}
                                    <abbr title="NOT signed">
                                        <img alt="No" src="/static/images/general/error_mark_small.png">
                                    </abbr>
                                {% endif %}
                            </center>
                            </td>
                            <td scope="col">
                               <center>
                                {% if result.record.clear_signed %}
                                    {% if result.record.clear_sig_verified %}
                                        <abbr title="Signed separately from any encryption.">
                                            <img alt="Yes" src="/static/images/general/check_mark_small.png">
                                        </abbr>
                                    {% else %}
                                        <abbr title="Signed separately from any encryption. Signature NOT verified.">
                                            <img alt="Yes*" src="/static/images/general/error_mark_small.png">
                                        </abbr>
                                    {% endif %}
                                {% else %}
                                    <abbr title="NOT signed">
                                        <img alt="No" src="/static/images/general/error_mark_small.png">
                                    </abbr>
                                {% endif %}
                                </center>
                            </td>
                            <td scope="col">
                               <center>
                                {% if result.record.dkim_signed %}
                                    {% if result.record.dkim_sig_verified %}
                                        <abbr title="Signed with sender's mail server key.">
                                            <img alt="Yes" src="/static/images/general/check_mark_small.png">
                                        </abbr>
                                    {% else %}
                                        <abbr title="Signature NOT verified.">
                                            <img alt="Yes*" src="/static/images/general/error_mark_small.png">
                                        </abbr>
                                    {% endif %}
                                {% else %}
                                    <abbr title="NOT signed">
                                        <img alt="No" src="/static/images/general/error_mark_small.png">
                                    </abbr>
                                {% endif %}
                                </center>
                            </td>
                            {% endblock signatures %}

                            {% block verification %}
                            <td scope="col">
                               <div class="text">
                                    {{ result.record.message_id }}
                                </div>
                            </td>
                            <td scope="col">
                               <div class="text">
                                    {{ result.record.verification_code }}
                                </div>
                            </td>
                            {% endblock verification %}

            {% block error_details %}
                <p class="dropcap">
                    Please be sure that you entered the correct verification code.
                </p>
            {% endblock error_details %}

